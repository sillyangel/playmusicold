<!DOCTYPE html>
<html>
<head>
    <title>Customized HTML Audio Player</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css">
    <link rel="stylesheet" href="main.css">
</head>
<body>
    <h1>Customized Audio Player</h1>
    <div class="audio-controls">
        <div id="currentTrack"> </div>
        <button onclick="previousAlbum()"><i class="fas fa-chevron-left"></i></button>
        <button onclick="previousTrack()"><i class="fas fa-backward"></i></button>
        <button onclick="playPause()"><i class="fas fa-play"></i></button>
        <button onclick="skipTrack()"><i class="fas fa-forward"></i></button>
        <button onclick="nextAlbum()"><i class="fas fa-chevron-right"></i></button>
        <input type="range" id="volume" min="0" max="1" step="0.01" onchange="setVolume()">
        <div id="songTime">0:00</div>
        <progress id="progress" value="0" max="100" onclick="seek(event)"></progress>
        <div id="songDuration">0:00</div>
    </div>
    <p>This is still in beta. If you encounter any bugs or have songs or playlists you'd like to add, please email me at <a href="mailto:aced8800@students.kleinsd.net">aced8800@students.kleinsd.net</a>.</p>

    <audio id="myAudio" controls>
        Your browser does not support the audio element.
    </audio>

    <script>
        var audio = document.getElementById("myAudio");
        var playButton = document.querySelector(".audio-controls button:nth-of-type(3)");
        var volumeControl = document.getElementById("volume");
        var progressBar = document.getElementById("progress");
        var currentTrackIndex = 0;
        var audioTracks = {
            "tylerthecreator/wolf": [
                "WOLF.mp3",
                "Jamba.mp3",
                "Cowboy.mp3",
                "Awkward.mp3",
                "Domo23.mp3",
                "Answer.mp3",
                "Slater.mp3",
                "48.mp3",
                "Colossus.mp3",
                "10 PartyIsntOver_Campfire_Bimmer.mp3",
                "IFHY.mp3",
                "Pigs.mp3",
                "Parking Lot.mp3",
                "Rusty.mp3",
                "Trashwang.mp3",
                "Treehome95.mp3",
                "Tamale.mp3",
                "Lone.mp3"
            ],
            "arcticmonkeys/am": [
                "01 - Do I Wanna Know.mp3",
                "02 - R U Mine.mp3",
                "03 - One For the Road.mp3",
                "04 - Arabella.mp3",
                "05 - I Want It All.mp3",
                "06 - No. 1 Party Anthem.mp3",
                "07 - Mad Sounds.mp3",
                "08 - Fireside.mp3",
                "09 - Why'd You Only Call Me When You're High.mp3",
                "10 - Snap Out of It.mp3",
                "11 - Knee Socks.mp3",
                "12 - I Wanna Be Yours.mp3"
            ],
            "arcticmonkeys/humbug": [
                "01. My Propeller.mp3",
                "02. Crying Lightning.mp3",
                "03. Dangerous Animals.mp3",
                "04. Secret Door.mp3",
                "05. Potion Approaching.mp3",
                "06. Fire And The Thud.mp3",
                "07. Cornerstone.mp3",
                "08. Dance Little Liar.mp3",
                "09. pretty visitors.mp3",
                "10 the jeweller's hands.mp3",
                "11_red right hand(2)(2).mp3"
            ],
            "wallows/nonthinghappens": [
                "Only Friend.mp3",
                "Treacherous Doctor.mp3",
                "Sidelines.mp3",
                "Are You Bored Yet (feat. Clairo).mp3",
                "Scrawny.mp3",
                "Ice Cold Pool.mp3",
                "Worlds Apart.mp3",
                "What You Like.mp3",
                "Remember When.mp3",
                "I_m Full.mp3",
                "Do Not Wait.mp3"
            ]
        };
        var currentAlbum = "tylerthecreator/wolf";
        var albums = [
            { artist: "Tyler, The Creator", album: "Wolf", folder: "tylerthecreator/wolf" },
            { artist: "Arctic Monkeys", album: "AM", folder: "arcticmonkeys/am"},
            { artist: "Arctic Monkeys", album: "Humbug", folder: "arcticmonkeys/humbug"},
            { artist: "Wallows", album: "Nothing Happens", folder: "wallows/nonthinghappens"},
            
            // Add more albums here
        ];
        var currentAlbumIndex = 0;
        var currentTrackText = document.getElementById("currentTrack");

        function loadTrack() {
    var trackPath = audioTracks[currentAlbum][currentTrackIndex];
    audio.src = "songs/" + currentAlbum + "/" + trackPath;
    audio.load();
    updateTrackText();
}

        function playPause() {
            if (audio.paused) {
                audio.play();
                playButton.innerHTML = '<i class="fas fa-pause"></i>';
            } else {
                audio.pause();
                playButton.innerHTML = '<i class="fas fa-play"></i>';
            }
        }

        function setVolume() {
            audio.volume = volumeControl.value;
        }

        function skipTrack() {
            currentTrackIndex++;
            if (currentTrackIndex >= audioTracks[currentAlbum].length) {
                currentTrackIndex = 0; // Loop back to the first track
            }
            loadTrack();
            audio.play();
        }

        function previousTrack() {
            currentTrackIndex--;
            if (currentTrackIndex < 0) {
                currentTrackIndex = audioTracks[currentAlbum].length - 1; // Go to the last track
            }
            loadTrack();
            audio.play();
        }

        function seek(event) {
            const percent = event.offsetX / progressBar.offsetWidth;
            const seekTime = percent * audio.duration;
            audio.currentTime = seekTime;
        }

        function nextAlbum() {
    currentAlbumIndex++;
    if (currentAlbumIndex >= albums.length) {
        currentAlbumIndex = 0; // Loop back to the first album
    }
    currentAlbum = albums[currentAlbumIndex].folder;
    currentTrackIndex = 0;
    
    // Check if audioTracks[currentAlbum] exists before loading
    if (audioTracks[currentAlbum]) {
        loadTrack();
        audio.play();
    } else {
        // Handle the case when the album is not found
        console.error("Album not found: " + currentAlbum);
    }
}

        function previousAlbum() {
            currentAlbumIndex--;
            if (currentAlbumIndex < 0) {
                currentAlbumIndex = albums.length - 1; // Go to the last album
            }
            currentAlbum = albums[currentAlbumIndex].folder;
            currentTrackIndex = 0;
            loadTrack();
            audio.play();
        }

        audio.addEventListener("timeupdate", function() {
    var currentTime = audio.currentTime;
    var duration = audio.duration;

    // Check if duration is a finite number before calculating percentComplete
    if (isFinite(duration)) {
        var percentComplete = (currentTime / duration) * 100;
        progressBar.value = percentComplete;
    }
});


        // Load the first track when the page loads
        loadTrack();

        // Event listener for when the current track ends
        audio.addEventListener("ended", function() {
            // Play the next track automatically
            skipTrack();
        });

        function updateTrackText() {
            var artist = albums[currentAlbumIndex].artist;
            var album = albums[currentAlbumIndex].album;
            var track = audioTracks[currentAlbum][currentTrackIndex];
            currentTrackText.textContent =  artist + " - " + album + " - " + track;
        }
        // Add these lines to update the song duration and current time
var songTimeElement = document.getElementById("songTime");
var songDurationElement = document.getElementById("songDuration");

audio.addEventListener("timeupdate", function() {
    var currentTime = audio.currentTime;
    var duration = audio.duration;

    // Check if duration is a finite number before calculating percentComplete
    if (isFinite(duration)) {
        var percentComplete = (currentTime / duration) * 100;
        progressBar.value = percentComplete;

        // Update the song duration and current time
        var currentMinutes = Math.floor(currentTime / 60);
        var currentSeconds = Math.floor(currentTime % 60);
        var durationMinutes = Math.floor(duration / 60);
        var durationSeconds = Math.floor(duration % 60);

        // Display current time and duration in the format "M:SS"
        songTimeElement.textContent = currentMinutes + ":" + (currentSeconds < 10 ? "0" : "") + currentSeconds;
        songDurationElement.textContent = durationMinutes + ":" + (durationSeconds < 10 ? "0" : "") + durationSeconds;
    }
});

    </script>
</body>
</html>
